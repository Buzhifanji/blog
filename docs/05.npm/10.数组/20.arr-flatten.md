---
title: arr-flatten
date: 2022-03-25 12:18:35
permalink: /pages/df111c/
categories:
  - npm
  - 数组
tags:
  - npm
  - 数组
---

:::theorem arr-flatten
递归扁平化数组
::: right
来自 [github](https://github.com/jonschlinkert/arr-flatten)
:::

## 用例

```javascript
var flatten = require('arr-flatten');

flatten(['a', ['b', ['c']], 'd', ['e']]);
//=> ['a', 'b', 'c', 'd', 'e']

arr-flatten 数组接受一个一维或多维数组，返回一个一维数组

```

## 源码

```javascript
// 采用递归思路实现
module.exports = function (arr) {
  // 传入空数组，缓存结果
  return flat(arr, []);
};

function flat(arr, res) {
  var i = 0, cur;
  var len = arr.length;
  for (; i < len; i++) {
    cur = arr[i];
    // 如果是数组，就递归调用自己，否则就push到res数组。
    Array.isArray(cur) ? flat(cur, res) : res.push(cur);
  }
  // 扁平化数组
  return res;
}
```

## 测试

array-last 采用测试库是[ mocha ](https://github.com/mochajs/mocha)

值得一看的测试用例

```javascript
  it('should flatten deeply nested arrays:', function() {
    // 深层次嵌套 测试用例
    assert.deepEqual(flatten(['a', [[[[[[[['b', [['c']]]]]], 'd', ['e']]]]]]), ['a', 'b', 'c', 'd', 'e']);
    assert.deepEqual(flatten(['a', 'b', ['c'], 'd', ['e']]), ['a', 'b', 'c', 'd', 'e']);
    // 深层次嵌套 测试用例
    assert.deepEqual(flatten([['a', ['b', ['k', ['a', ['b', ['c'], [['a', [['a', ['b', ['k', ['a', ['b', ['c']], ['a', ['x', ['c'], ['a', ['x', ['k']]], ['d', ['z']]]], ['d', ['m']]], ['d', ['e']]]]], ['d', ['e']]], ['b', ['k', ['a', ['b', ['c']], ['a', ['x', ['c'], ['a', ['x', ['k']]], ['d', ['z']]]], ['d', ['m']]], ['d', ['e']]]]], ['d', ['e']]]], ['a', ['x', ['c'], ['a', ['x', ['k']], [['a', ['b', ['k', ['a', ['b', ['c']], ['a', ['x', ['c'], ['a', ['x', ['k']]], ['d', ['z']]]], ['d', ['m']]], ['d', ['e']]]]], ['d', ['e']]]], ['d', ['z']]]], ['d', ['m']]], ['d', ['e']]]]], ['d', ['e']]]), [ 'a', 'b', 'k', 'a', 'b', 'c', 'a', 'a', 'b', 'k', 'a', 'b', 'c', 'a', 'x', 'c', 'a', 'x', 'k', 'd', 'z', 'd', 'm', 'd', 'e', 'd', 'e', 'b', 'k', 'a', 'b', 'c', 'a', 'x', 'c', 'a', 'x', 'k', 'd', 'z', 'd', 'm', 'd', 'e', 'd', 'e', 'a', 'x', 'c', 'a', 'x', 'k', 'a', 'b', 'k', 'a', 'b', 'c', 'a', 'x', 'c', 'a', 'x', 'k', 'd', 'z', 'd', 'm', 'd', 'e', 'd', 'e', 'd', 'z', 'd', 'm', 'd', 'e', 'd', 'e' ]);
  });
```

## 总结

arr-flatten 的用途：扁平化数组。

arr-flatten 的实现很简单，通过for循环，逐层展平每个元素。如果当前元素是数组，那么就递归对它进行处理，最后将递归处理的结果拼接到数组上。

arr-flatten 实现了 ES6 [ flat ](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/flat)功能